<?xml version="1.0" ?>
<!-- Create a new symmetric key. Then add the Activation Date and
Deactivation Date attributes based on the timestamp in the response to the
Create request. The Activation Date is set to the current time and the
Deactivation Date to a time in the near future. Repeated Get Attribute calls
are performed to verify that the state is first 'Active', then subsequently
'Deactivated'. Then issue a Re-key request, including an Offset value of zero
leading to the Activation Date of the replacement key to be set to the same
value as the Initial Date of the replacement key. Verify from the response that
the Activation Date and Deactivation Date attributes were set correctly (if they
are not returned, issue a Get Attribute request). Do a Get Attribute operation
to verify that the state of the new key is 'Active'. To clean up, both keys are
deleted. -->
<KMIP>
# TIME 0
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="Create"/>
			<RequestPayload>
				<ObjectType type="Enumeration" value="SymmetricKey"/>
				<TemplateAttribute>
					<Attribute>
						<AttributeName type="TextString" value="Cryptographic Algorithm"/>
						<AttributeValue type="Enumeration" value="AES"/>
					</Attribute>
					<Attribute>
						<AttributeName type="TextString" value="Cryptographic Length"/>
						<AttributeValue type="Integer" value="128"/>
					</Attribute>
					<Attribute>
						<AttributeName type="TextString" value="Cryptographic Usage Mask"/>
						<AttributeValue type="Integer" value="Decrypt   Encrypt"/>
					</Attribute>
					<Attribute>
						<AttributeName type="TextString" value="Name"/>
						<AttributeValue>
							<NameValue type="TextString" value="TC-92-11-rekeyKey"/>
							<NameType type="Enumeration" value="UninterpretedTextString"/>
						</AttributeValue>
					</Attribute>
				</TemplateAttribute>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:12:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="Create"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<ObjectType type="Enumeration" value="SymmetricKey"/>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 1
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="2"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="AddAttribute"/>
			<UniqueBatchItemID type="ByteString" value="606051f958d79b0f"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Attribute>
					<AttributeName type="TextString" value="Activation Date"/>
					<AttributeValue type="DateTime" value="$NOW"/>
				</Attribute>
			</RequestPayload>
		</BatchItem>
		<BatchItem>
			<Operation type="Enumeration" value="AddAttribute"/>
			<UniqueBatchItemID type="ByteString" value="7cb12802f6a52cf1"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Attribute>
					<AttributeName type="TextString" value="Deactivation Date"/>
					<AttributeValue type="DateTime" value="$NOW+120"/>
				</Attribute>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:12:27+00:00"/>
			<BatchCount type="Integer" value="2"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="AddAttribute"/>
			<UniqueBatchItemID type="ByteString" value="606051f958d79b0f"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Attribute>
					<AttributeName type="TextString" value="Activation Date"/>
					<AttributeValue type="DateTime" value="$NOW"/>
				</Attribute>
			</ResponsePayload>
		</BatchItem>
		<BatchItem>
			<Operation type="Enumeration" value="AddAttribute"/>
			<UniqueBatchItemID type="ByteString" value="7cb12802f6a52cf1"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Attribute>
					<AttributeName type="TextString" value="Deactivation Date"/>
					<AttributeValue type="DateTime" value="$NOW+120"/>
				</Attribute>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 2
# [REPEAT] until   GetAttributes response shows State changed to Deactivated
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<AttributeName type="TextString" value="State"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:12:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Attribute>
					<AttributeName type="TextString" value="State"/>
					<AttributeValue type="Enumeration" value="Active"/>
				</Attribute>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 3
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<AttributeName type="TextString" value="State"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:14:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Attribute>
					<AttributeName type="TextString" value="State"/>
					<AttributeValue type="Enumeration" value="Deactivated"/>
				</Attribute>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 4
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="ReKey"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
				<Offset type="Interval" value="0"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:14:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="ReKey"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 5
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
				<AttributeName type="TextString" value="Activation Date"/>
				<AttributeName type="TextString" value="Deactivation Date"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:14:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
				<Attribute>
					<AttributeName type="TextString" value="Activation Date"/>
					<AttributeValue type="DateTime" value="$NOW"/>
				</Attribute>
				<Attribute>
					<AttributeName type="TextString" value="Deactivation Date"/>
					<AttributeValue type="DateTime" value="$NOW+120"/>
				</Attribute>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 6
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
				<AttributeName type="TextString" value="State"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:14:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="GetAttributes"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
				<Attribute>
					<AttributeName type="TextString" value="State"/>
					<AttributeValue type="Enumeration" value="Active"/>
				</Attribute>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 7
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchCount type="Integer" value="1"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="Destroy"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:14:27+00:00"/>
			<BatchCount type="Integer" value="1"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="Destroy"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
# TIME 8
	<RequestMessage>
		<RequestHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<BatchOrderOption type="Boolean" value="true"/>
			<BatchCount type="Integer" value="2"/>
		</RequestHeader>
		<BatchItem>
			<Operation type="Enumeration" value="Revoke"/>
			<UniqueBatchItemID type="ByteString" value="955dfbb9abbec308"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
				<RevocationReason>
					<RevocationReasonCode type="Enumeration" value="CessationOfOperation"/>
				</RevocationReason>
			</RequestPayload>
		</BatchItem>
		<BatchItem>
			<Operation type="Enumeration" value="Destroy"/>
			<UniqueBatchItemID type="ByteString" value="6ce5ea0c8334b076"/>
			<RequestPayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
			</RequestPayload>
		</BatchItem>
	</RequestMessage>
	<ResponseMessage>
		<ResponseHeader>
			<ProtocolVersion>
				<ProtocolVersionMajor type="Integer" value="1"/>
				<ProtocolVersionMinor type="Integer" value="1"/>
			</ProtocolVersion>
			<TimeStamp type="DateTime" value="2012-04-27T08:14:27+00:00"/>
			<BatchCount type="Integer" value="2"/>
		</ResponseHeader>
		<BatchItem>
			<Operation type="Enumeration" value="Revoke"/>
			<UniqueBatchItemID type="ByteString" value="955dfbb9abbec308"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
			</ResponsePayload>
		</BatchItem>
		<BatchItem>
			<Operation type="Enumeration" value="Destroy"/>
			<UniqueBatchItemID type="ByteString" value="6ce5ea0c8334b076"/>
			<ResultStatus type="Enumeration" value="Success"/>
			<ResponsePayload>
				<UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_1"/>
			</ResponsePayload>
		</BatchItem>
	</ResponseMessage>
</KMIP>
